<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.reviewimg">
<resultMap type="review_image_dto" id="reviewImageResult">
	<result property="imageFileNo" column="imageFileNo"/>
	<result property="imageFileName" column="imageFileName"/>
	<result property="regDate" column="regDate"/>
	<result property="review_no" column="review_no"/>
</resultMap>

<!-- 게시글 이미지 등록 -->
<insert id="insertImage" parameterType="review_image_dto">
	<![CDATA[
		insert into review_board_image (imageFileNo, imageFileName, regDate, review_no)
		values (review_board_image_seq.nextval, #{imageFileName}, sysdate, #{review_no})
	]]>
</insert>

<select id="selectNewImageFileNo" resultType="int">
			<![CDATA[
				select max(imageFileNo)+1 from REVIEW_BOARD
			]]>
		</select>
		
<!-- 게시글 이미지 가져오기 -->
<select id="getImageByNo" parameterType="int" resultMap="reviewImageResult">
	<![CDATA[
		select * from review_board_image where imageFileNo=#{imageFileNo}
	]]>
</select>

<!-- 게시글 이미지 삭제 -->
<delete id="deleteImage" parameterType="int">
	<![CDATA[
		delete from review_board_image where imageFileNo=#{imageFileNo}
	]]>
</delete>

<!-- 게시글 이미지 모두 삭제 -->
<delete id="deleteAllImages" parameterType="int">
	<![CDATA[
		delete from review_board_image where review_no=#{review_no}
	]]>
</delete>

<!-- 게시글 이미지 목록 가져오기 -->
<select id="getImagesByArticleNo" parameterType="int" resultMap="reviewImageResult">
	<![CDATA[
		select * from review_board_image where review_no=#{review_no}
	]]>
</select>
</mapper>